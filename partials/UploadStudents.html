<div class="greybox">
    <div class="">
        <h1>Upload Students</h1>
        <form action="" method="post" enctype="multipart/form-data">
            <div class='form-group'>

                <h2>Excel File</h2>
                <input type="file" name="excel_file" accept=".xlsx" onchange="angular.element(this).scope().fileChanged(this.files);" required="true">
            </div>



            <div class='form-group' style="width:100%;float:left">
                <h2>Sheet Name</h2>
                <select id="sheet_name" class="form-control" ng-model="selectedSheetName" required="true" ng-required="true" ng-options="sheetName as sheetName for (sheetName, sheetData) in sheets">
                    <option value="">---- Select a sheet ----</option>
                </select>
            </div>
            <div class='form-group' >
                <h2>Show preview of excel file</h2>
                <input type="checkbox" ng-model="showPreview" ng-change="showPreviewChanged();"/>
            </div>
            <input type="hidden" name="sheet_name" value="{{ selectedSheetName }}">
            <div class='form-group'>
            <input type="submit" value="Submit" ng-click="upload()">
                </div>

            <div ng-show="showPreview">
                <table class="table table-bordered" ng-repeat="(sheetName, sheetData) in sheets" ng-show="sheetName == selectedSheetName">
                    <thead>
                    <tr>
                        <th ng-bind="sheetName"></th>
                    </tr>
                    </thead>
                    <tr ng-repeat="row in sheetData.data">
                        <td ng-repeat="col in row" ng-bind="col"></td>
                    </tr>
                </table>
            </div>

        </form>
    </div>
</div>
